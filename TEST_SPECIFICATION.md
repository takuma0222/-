# 従業員NOチェック機能 - テスト仕様書

## テスト概要
従業員NOを6桁入力した際に、CSVファイルから氏名を検索して表示する機能のテストケース。

## テスト前提条件
- アプリケーションが正常に起動していること
- `data\employees.csv` ファイルが存在し、以下のサンプルデータが含まれていること：
```csv
EmployeeNo,Name
123456,山田太郎
234567,佐藤花子
345678,鈴木一郎
456789,田中美咲
567890,高橋健太
```

## テストケース

### TC-01: 成功ケース - 該当する従業員NOの検索
**前提条件**: CSVに従業員NO「123456」が存在する

**手順**:
1. アプリケーションを起動
2. 従業員Noフィールドに「123456」と入力

**期待結果**:
- 従業員名ラベルに「山田太郎」が青文字で表示される
- カードNoフィールドが活性化される
- フォーカスがカードNoフィールドに移動する
- メッセージエリアに「カードNoを入力してください」と表示される
- ログに検索成功のエントリが記録される

---

### TC-02: 失敗ケース - 該当しない従業員NOの検索
**前提条件**: CSVに従業員NO「999999」が存在しない

**手順**:
1. アプリケーションを起動
2. 従業員Noフィールドに「999999」と入力

**期待結果**:
- 従業員名ラベルに「該当するユーザがありません。」と赤文字で表示される
- メッセージエリアに「該当するユーザがありません。」と赤文字で表示される
- 従業員Noフィールドがクリアされる
- フォーカスが従業員Noフィールドに戻る
- カードNoフィールドが非活性のまま
- ログに検索失敗のエントリが記録される

---

### TC-03: バリデーション - 6桁未満の入力
**手順**:
1. アプリケーションを起動
2. 従業員Noフィールドに「12345」（5桁）と入力

**期待結果**:
- 自動検索は実行されない
- 従業員名ラベルは空のまま
- カードNoフィールドは非活性のまま
- メッセージエリアに「従業員Noを6桁で入力してください」と表示される

---

### TC-04: バリデーション - 数字以外の入力
**手順**:
1. アプリケーションを起動
2. 従業員Noフィールドにアルファベット（例: 「abc」）を入力しようとする

**期待結果**:
- アルファベットは入力できない（KeyPressイベントで制限）
- 数字のみが入力可能

---

### TC-05: 非同期処理 - ローディング表示
**手順**:
1. アプリケーションを起動
2. 従業員Noフィールドに「123456」と入力
3. 検索中のローディング表示を確認

**期待結果**:
- 6桁目入力後、一時的に「読み込み中...」が表示される
- 検索完了後、ローディング表示が消える
- UI がフリーズしない（非同期処理）

---

### TC-06: エラーハンドリング - CSVファイルが存在しない
**前提条件**: `data\employees.csv` ファイルが存在しない、または削除されている

**手順**:
1. アプリケーションを起動
2. 従業員Noフィールドに「123456」と入力

**期待結果**:
- メッセージエリアに「データ読み取りエラーが発生しました」と赤文字で表示される
- 従業員Noフィールドがクリアされる
- フォーカスが従業員Noフィールドに戻る
- エラーログに詳細（ファイルパスとスタックトレース）が記録される

---

### TC-07: 機能連携 - カードNo入力への遷移
**手順**:
1. アプリケーションを起動
2. 従業員Noフィールドに「123456」と入力
3. カードNoフィールドに「e00123」と入力

**期待結果**:
- 従業員名「山田太郎」が表示されたまま
- カード条件が DataGridView に表示される
- 照合ボタンが活性化される

---

### TC-08: リセット機能
**手順**:
1. アプリケーションを起動
2. 従業員Noフィールドに「123456」と入力（氏名が表示される）
3. キャンセルボタンをクリック

**期待結果**:
- 従業員Noフィールドがクリアされる
- 従業員名ラベルがクリアされる
- カードNoフィールドがクリアされ、非活性化される
- メッセージエリアに「従業員Noを入力してください」と表示される
- フォーカスが従業員Noフィールドに戻る

---

## パフォーマンステスト

### PT-01: 大量データでの検索速度
**前提条件**: CSVファイルに1000件以上の従業員データが含まれている

**手順**:
1. 従業員Noを入力
2. 検索完了までの時間を計測

**期待結果**:
- 検索が1秒以内に完了する
- UI がフリーズしない

---

## 自動テスト実装案（将来的な拡張）

現在のプロジェクトには自動テストフレームワークがないため、以下のテストは手動で実施します。
将来的には、以下のような単体テストの実装を推奨します：

### EmployeeLoaderクラスのテスト
```vb
' テストフレームワーク: NUnit または xUnit を推奨

' Test: GetEmployeeNameAsync_ExistingEmployee_ReturnsName
' 期待: 存在する従業員NOで氏名が返される

' Test: GetEmployeeNameAsync_NonExistingEmployee_ReturnsNothing
' 期待: 存在しない従業員NOでNothingが返される

' Test: LoadAsync_InvalidCsvPath_ThrowsException
' 期待: 無効なパスで例外がスローされる

' Test: LoadAsync_EmptyCsv_ThrowsException
' 期待: 空のCSVで例外がスローされる
```

---

## ログ確認

テスト実行後、以下のログファイルを確認して詳細を検証：
- 場所: `logs\error\[日付].log`
- 確認項目:
  - 検索成功時のログエントリ
  - 検索失敗時のログエントリ（従業員NO含む）
  - エラー発生時の詳細（スタックトレース含む）

---

## テスト実行記録

| テストケース | 実施日 | 結果 | 備考 |
|-------------|--------|------|------|
| TC-01       |        |      |      |
| TC-02       |        |      |      |
| TC-03       |        |      |      |
| TC-04       |        |      |      |
| TC-05       |        |      |      |
| TC-06       |        |      |      |
| TC-07       |        |      |      |
| TC-08       |        |      |      |
| PT-01       |        |      |      |
