# 従業員NOチェック機能 使用方法

## 概要

従業員NOをローカルのCSVファイルから検索し、氏名を画面に表示する機能です。

## セットアップ

### 1. CSVファイルの配置

アプリケーション実行ファイル(BalanceInspection.exe)と同じフォルダに `data` ディレクトリを作成し、その中に `employees.csv` ファイルを配置してください。

```
BalanceInspection.exe
data/
  └── employees.csv
```

### 2. CSVファイルの形式

- **エンコーディング**: UTF-8
- **区切り文字**: カンマ (,)
- **改行コード**: LF または CRLF
- **列数**: 2列（従業員NO, 氏名）
- **ヘッダー行**: なし

**サンプル (employees.csv)**:
```
123456,山田太郎
234567,佐藤花子
345678,鈴木一郎
456789,田中美咲
567890,高橋健太
```

## 使用方法

### 基本操作

1. アプリケーションを起動します
2. **従業員No** 欄に6桁の数字を入力します
3. 6桁入力が完了すると自動的に検索が実行されます（ボタン押下不要）

### 検索成功時の動作

- 氏名が従業員No欄の右側に表示されます
- カードNo入力欄が活性化します
- フォーカスが自動的にカードNo欄に移動します
- 画面下部のメッセージ欄に「カードNoを入力してください」と表示されます

### 該当なし時の動作

- 従業員No欄の右側に赤文字で「**該当するユーザがありません。**」と表示されます
- 画面下部のメッセージ欄にも同じ赤文字メッセージが表示されます
- 従業員No入力欄が自動的にクリアされます
- フォーカスが従業員No欄に戻ります

### エラー発生時の動作

CSVファイルが見つからない場合や読み取りエラーが発生した場合：

- 「**データ読み取りエラーが発生しました**」というメッセージが表示されます
- 詳細なエラー情報はログファイルに記録されます
- ログファイルの場所: `logs/error/yyyy-MM-dd.log`

## 入力ルール

- 従業員NOは**6桁の数字のみ**有効です
- 6桁未満の入力では検索は実行されません
- 数字以外の文字が含まれている場合、検索は実行されません

## トラブルシューティング

### 「データ読み取りエラーが発生しました」と表示される

**原因**:
- CSVファイルが存在しない
- CSVファイルの配置場所が正しくない
- CSVファイルのエンコーディングがUTF-8でない
- CSVファイルの読み取り権限がない

**対処法**:
1. `data/employees.csv` が正しい場所にあるか確認
2. ファイルをUTF-8で保存し直す
3. ファイルの読み取り権限を確認
4. ログファイル(`logs/error/yyyy-MM-dd.log`)で詳細を確認

### 検索が実行されない

**原因**:
- 入力が6桁に達していない
- 数字以外の文字が含まれている

**対処法**:
- 6桁の数字を入力してください
- 全角数字ではなく半角数字を使用してください

### 該当する従業員が表示されない

**原因**:
- CSVファイルに従業員NOが登録されていない
- CSVファイルの形式が正しくない（カンマ区切りでない、など）

**対処法**:
1. CSVファイルを開いて、該当の従業員NOが登録されているか確認
2. 従業員NOが6桁の数字であることを確認
3. カンマ区切りの形式が正しいことを確認

## ログ出力

従業員NO検索の動作はログファイルに記録されます：

- **検索実行**: 従業員NO検索が実行されるたびにログに記録
- **エラー**: ファイル未検出、読み取りエラー等の詳細がスタックトレース付きで記録

ログファイルの場所: `logs/error/yyyy-MM-dd.log`

ログ例:
```
[2025-11-05 10:30:15.123] 従業員NO検索: 123456
[2025-11-05 10:30:45.456] CSV file not found: C:\App\data\employees.csv
[2025-11-05 10:31:00.789] 従業員CSV読み込みエラー: ファイルが見つかりません
...
```

## 技術仕様

- **非同期処理**: CSV読み取りと検索は非同期で実行され、UIをブロックしません
- **検索中表示**: 検索実行中は「読み込み中…」と表示されます
- **二重実行防止**: 検索実行中は新たな検索要求を無視します
- **キャッシュ**: 一度読み込んだCSVデータはメモリにキャッシュされます

## 注意事項

- CSVファイルの更新を反映するにはアプリケーションの再起動が必要です
- 非常に大きなCSVファイル（数万行以上）を使用する場合、初回読み込みに時間がかかる可能性があります
- CSVファイル内に同じ従業員NOが複数存在する場合、最後に読み込まれた行のデータが使用されます
- CSVファイルはUTF-8エンコーディングで保存してください（それ以外のエンコーディングでは文字化けする可能性があります）
