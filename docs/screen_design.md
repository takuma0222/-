# 画面設計書

## 1. メイン照合画面（MainForm）

### 1.1 画面概要

| 項目 | 内容 |
|------|------|
| 画面ID | MAIN-001 |
| 画面名 | メイン照合画面 |
| 画面タイプ | メイン画面 |
| 役割 | 従業員認証、カード照合、部材照合を実施 |

### 1.2 画面レイアウト

```
┌─────────────────────────────────────────────────────────────────────┐
│  部材照合システム v1.0                                    [_][□][×]│
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  【従業員情報】                                                     │
│  ┌─────────────────────────────────────────────────┐             │
│  │ 従業員No: [__________]    従業員名: ___________  │             │
│  └─────────────────────────────────────────────────┘             │
│                                                                     │
│  【カード情報】                                                     │
│  ┌─────────────────────────────────────────────────┐             │
│  │ カードNo: [__________]    LAP厚: [250μm ▼]      │             │
│  │                                                   │             │
│  │ 品名: ___________    ロットNo: ___________       │             │
│  │ 棚番: ___________    完成型No: ___________       │             │
│  └─────────────────────────────────────────────────┘             │
│                                                                     │
│  【必要枚数】                                                       │
│  ┌─────────────────────────────────────────────────┐             │
│  │ 投入前10mm: __個  投入後1mm: __個  エッジガード: __個│         │
│  │ 投入後5mm: __個   投入後10mm: __個  気泡緩衝材: __個 │         │
│  └─────────────────────────────────────────────────┘             │
│                                                                     │
│  【照合結果】                                                       │
│  ┌─────────────────────────────────────────────────┐             │
│  │ ◆投入前10mm                                       │             │
│  │   照合前数: __個  確保数: __個  過不足: __個  [OK]│             │
│  │                                                   │             │
│  │ ◆投入後1mm                                        │             │
│  │   照合前数: __個  確保数: __個  過不足: __個  [--]│             │
│  │                                                   │             │
│  │ ◆投入後5mm                                        │             │
│  │   照合前数: __個  確保数: __個  過不足: __個  [--]│             │
│  │                                                   │             │
│  │ ◆投入後10mm                                       │             │
│  │   照合前数: __個  確保数: __個  過不足: __個  [--]│             │
│  │                                                   │             │
│  │ ◆エッジガード                                     │             │
│  │   照合前数: __個  確保数: __個  過不足: __個  [--]│             │
│  │                                                   │             │
│  │ ◆気泡緩衝材                                       │             │
│  │   照合前数: __個  確保数: __個  過不足: __個  [--]│             │
│  └─────────────────────────────────────────────────┘             │
│                                                                     │
│  【メッセージエリア】                                               │
│  ┌─────────────────────────────────────────────────┐             │
│  │ 従業員Noを入力してください                        │             │
│  └─────────────────────────────────────────────────┘             │
│                                                                     │
│  [照合実行]  [棚入庫]  [棚出庫]  [キャンセル]  [終了]              │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 1.3 項目定義

#### 1.3.1 従業員情報エリア

| 項目名 | コントロール名 | コントロール型 | 初期値 | 必須 | 最大長 | 説明 |
|--------|---------------|---------------|--------|------|--------|------|
| 従業員No | txtEmployeeNo | TextBox | 空白 | ○ | 6 | 6桁の従業員番号 |
| 従業員名 | lblEmployeeNameValue | Label | 空白 | - | - | 従業員マスタから取得 |

**バリデーション**:
- 従業員No: 半角数字6桁、従業員マスタに存在すること

**イベント**:
- txtEmployeeNo.TextChanged: 従業員名自動取得

---

#### 1.3.2 カード情報エリア

| 項目名 | コントロール名 | コントロール型 | 初期値 | 必須 | 最大長 | 説明 |
|--------|---------------|---------------|--------|------|--------|------|
| カードNo | txtCardNo | TextBox | 空白 | ○ | 10 | カード番号 |
| LAP厚 | cmbLapThickness | ComboBox | 250μm | ○ | - | LAP厚選択（250μm/300μm） |
| 品名 | lblProductNameValue | Label | 空白 | - | - | カード条件から取得 |
| ロットNo | lblLotNoValue | Label | 空白 | - | - | カード条件から取得 |
| 棚番 | lblShelfNoValue | Label | 空白 | - | - | カード条件から取得 |
| 完成型No | lblCompleteTypeNoValue | Label | 空白 | - | - | カード条件から取得 |

**バリデーション**:
- カードNo: 英数字10文字、カード条件CSVに存在すること
- LAP厚: 250μm or 300μmのみ

**イベント**:
- txtCardNo.KeyDown: Enterキーで部材条件取得
- cmbLapThickness.SelectedIndexChanged: 部材条件再取得

---

#### 1.3.3 必要枚数エリア

| 項目名 | コントロール名 | コントロール型 | 初期値 | 説明 |
|--------|---------------|---------------|--------|------|
| 投入前10mm | lblPre10mmRequired | Label | 0個 | 必要枚数（MaterialConditionから取得） |
| 投入後1mm | lblPost1mmRequired | Label | 0個 | 必要枚数（MaterialConditionから取得） |
| 投入後5mm | lblPost5mmRequired | Label | 0個 | 必要枚数（MaterialConditionから取得） |
| 投入後10mm | lblPost10mmRequired | Label | 0個 | 必要枚数（MaterialConditionから取得） |
| エッジガード | lblEdgeGuardRequired | Label | 0個 | 必要枚数（CardConditionから取得） |
| 気泡緩衝材 | lblBubbleRequired | Label | 0個 | 必要枚数（CardConditionから取得） |

---

#### 1.3.4 照合結果エリア

##### 投入前10mm

| 項目名 | コントロール名 | コントロール型 | 初期値 | 説明 |
|--------|---------------|---------------|--------|------|
| 照合前数 | lblPre10mmRemaining | Label | 0個 | 天秤から取得した枚数 |
| 確保数 | lblPre10mmSecured | Label | 0個 | 照合後の枚数 |
| 過不足 | lblPre10mmUsed | Label | 0個 | 過不足数（負の場合は過剰） |
| 判定 | lblPre10mmJudgment | Label | -- | OK（緑）/不足（赤）/過剰（赤） |

##### 投入後1mm、投入後5mm、投入後10mm、エッジガード、気泡緩衝材

上記と同様の項目構成（コントロール名のプレフィックスが異なる）

**色分け仕様**:
- OK判定: 緑（Color.Green）
- 不足/過剰判定: 赤（Color.Red）
- 未照合: 黒（Color.Black）

---

#### 1.3.5 メッセージエリア

| 項目名 | コントロール名 | コントロール型 | 初期値 | 説明 |
|--------|---------------|---------------|--------|------|
| メッセージ | lblMessage | Label | 従業員Noを入力してください | システムメッセージ表示 |

**色分け仕様**:
- 情報メッセージ: 黒（Color.Black）
- 成功メッセージ: 緑（Color.Green）
- エラーメッセージ: 赤（Color.Red）

---

#### 1.3.6 ボタン

| ボタン名 | コントロール名 | 初期状態 | 説明 |
|----------|---------------|----------|------|
| 照合実行 | btnVerify | 無効 | 第1段階/第2段階照合実行 |
| 棚入庫 | btnShelfStorage | 無効 | 棚入庫画面表示 |
| 棚出庫 | btnShelfRetrieval | 有効 | 棚出庫画面表示 |
| キャンセル | btnCancel | 有効 | 入力内容クリア |
| 終了 | btnExit | 有効 | アプリケーション終了 |

**活性制御**:

| 状態 | 照合実行 | 棚入庫 | 棚出庫 | キャンセル | 終了 |
|------|----------|--------|--------|-----------|------|
| 初期状態 | 無効 | 無効 | 有効 | 有効 | 有効 |
| カード情報取得完了 | 有効 | 無効 | 有効 | 有効 | 有効 |
| 第1段階完了 | 有効 | 無効 | 有効 | 有効 | 有効 |
| 照合完了 | 無効 | 有効 | 有効 | 有効 | 有効 |

---

### 1.4 イベント一覧

| イベント | トリガー | 処理内容 |
|----------|---------|----------|
| Load | 画面表示時 | InitializeServices()実行 |
| txtEmployeeNo.TextChanged | 従業員No入力時 | 従業員名取得・表示 |
| txtCardNo.KeyDown | カードNo入力後Enter | カード条件・部材条件取得 |
| cmbLapThickness.SelectedIndexChanged | LAP厚変更時 | 部材条件再取得 |
| btnVerify.Click | 照合実行ボタン押下 | 第1段階/第2段階照合実行 |
| btnShelfStorage.Click | 棚入庫ボタン押下 | ShelfStorageForm表示 |
| btnShelfRetrieval.Click | 棚出庫ボタン押下 | ShelfRetrievalForm表示 |
| btnCancel.Click | キャンセルボタン押下 | ResetForm()実行 |
| btnExit.Click | 終了ボタン押下 | Application.Exit() |

---

### 1.5 画面遷移

```
[初期状態]
  ↓ 従業員No入力
[従業員認証完了]（従業員名表示）
  ↓ カードNo、LAP厚入力 → Enter
[カード情報取得完了]（カード情報・必要枚数表示）
  ↓ 照合実行ボタン押下
[第1段階照合実行中]
  ├─ OK → [第1段階完了]（投入前10mm照合結果表示、第2段階へ）
  └─ NG → [カード情報取得完了]（エラーメッセージ表示）
  ↓ 照合実行ボタン押下
[第2段階照合実行中]
  ├─ OK → [照合完了]（全照合結果表示、棚入庫ボタン活性化）
  └─ NG → [第1段階完了]（エラーメッセージ表示）
  ↓ 棚入庫ボタン押下
[棚入庫画面へ遷移]
```

---

## 2. 棚入庫画面（ShelfStorageForm）

### 2.1 画面概要

| 項目 | 内容 |
|------|------|
| 画面ID | SHELF-001 |
| 画面名 | 棚入庫画面 |
| 画面タイプ | サブ画面（モーダル） |
| 役割 | 照合済カードの棚入庫登録 |

### 2.2 画面レイアウト

```
┌──────────────────────────────────────────────┐
│  棚入庫                          [_][□][×]│
├──────────────────────────────────────────────┤
│                                              │
│  【入庫情報】                                │
│  ┌────────────────────────────────┐         │
│  │ カードNo: E00123                │         │
│  │ 品名: AAA                        │         │
│  │ ロットNo: 000001###              │         │
│  │ 完成型No: 00001                  │         │
│  │ 棚番: A-01                       │         │
│  └────────────────────────────────┘         │
│                                              │
│  【入庫データ入力】                          │
│  ┌────────────────────────────────┐         │
│  │ 入庫日時: 2025-11-10 14:30:00   │         │
│  │ 入庫担当者: 123456 (山田太郎)   │         │
│  │ 備考: [_________________________]│         │
│  └────────────────────────────────┘         │
│                                              │
│  【メッセージエリア】                        │
│  ┌────────────────────────────────┐         │
│  │ 入庫情報を確認してください      │         │
│  └────────────────────────────────┘         │
│                                              │
│  [入庫実行]  [キャンセル]                   │
│                                              │
└──────────────────────────────────────────────┘
```

### 2.3 項目定義

#### 2.3.1 入庫情報エリア（読み取り専用）

| 項目名 | コントロール名 | コントロール型 | 説明 |
|--------|---------------|---------------|------|
| カードNo | lblCardNo | Label | メイン画面から引き継ぎ |
| 品名 | lblProductName | Label | メイン画面から引き継ぎ |
| ロットNo | lblLotNo | Label | メイン画面から引き継ぎ |
| 完成型No | lblCompleteTypeNo | Label | メイン画面から引き継ぎ |
| 棚番 | lblShelfNo | Label | メイン画面から引き継ぎ |

#### 2.3.2 入庫データ入力エリア

| 項目名 | コントロール名 | コントロール型 | 初期値 | 必須 | 最大長 | 説明 |
|--------|---------------|---------------|--------|------|--------|------|
| 入庫日時 | lblStorageDateTime | Label | 現在日時 | ○ | - | 自動設定 |
| 入庫担当者 | lblStorageEmployee | Label | メイン画面の従業員No・名 | ○ | - | メイン画面から引き継ぎ |
| 備考 | txtRemarks | TextBox | 空白 | × | 100 | 任意入力 |

#### 2.3.3 ボタン

| ボタン名 | コントロール名 | 初期状態 | 説明 |
|----------|---------------|----------|------|
| 入庫実行 | btnExecute | 有効 | 棚入庫実行、CSV書込 |
| キャンセル | btnCancel | 有効 | 画面を閉じる |

### 2.4 イベント一覧

| イベント | トリガー | 処理内容 |
|----------|---------|----------|
| Load | 画面表示時 | メイン画面からデータ引き継ぎ、現在日時設定 |
| btnExecute.Click | 入庫実行ボタン押下 | 入庫データをCSVに書込、DialogResult.OKで閉じる |
| btnCancel.Click | キャンセルボタン押下 | DialogResult.Cancelで閉じる |

---

## 3. 棚出庫画面（ShelfRetrievalForm）

### 3.1 画面概要

| 項目 | 内容 |
|------|------|
| 画面ID | SHELF-002 |
| 画面名 | 棚出庫画面 |
| 画面タイプ | サブ画面（モーダル） |
| 役割 | 棚からのカード出庫登録 |

### 3.2 画面レイアウト

```
┌──────────────────────────────────────────────┐
│  棚出庫                          [_][□][×]│
├──────────────────────────────────────────────┤
│                                              │
│  【検索条件】                                │
│  ┌────────────────────────────────┐         │
│  │ カードNo: [__________] [検索]  │         │
│  └────────────────────────────────┘         │
│                                              │
│  【入庫データ】                              │
│  ┌────────────────────────────────┐         │
│  │ カードNo: E00123                │         │
│  │ 品名: AAA                        │         │
│  │ ロットNo: 000001###              │         │
│  │ 棚番: A-01                       │         │
│  │ 入庫日時: 2025-11-10 14:30:00   │         │
│  │ 入庫担当者: 123456 (山田太郎)   │         │
│  └────────────────────────────────┘         │
│                                              │
│  【出庫データ入力】                          │
│  ┌────────────────────────────────┐         │
│  │ 出庫日時: 2025-11-10 15:00:00   │         │
│  │ 出庫担当者: [______] (________)  │         │
│  │ 備考: [_________________________]│         │
│  └────────────────────────────────┘         │
│                                              │
│  【メッセージエリア】                        │
│  ┌────────────────────────────────┐         │
│  │ カードNoを入力してください      │         │
│  └────────────────────────────────┘         │
│                                              │
│  [出庫実行]  [キャンセル]                   │
│                                              │
└──────────────────────────────────────────────┘
```

### 3.3 項目定義

#### 3.3.1 検索条件エリア

| 項目名 | コントロール名 | コントロール型 | 初期値 | 必須 | 最大長 | 説明 |
|--------|---------------|---------------|--------|------|--------|------|
| カードNo | txtCardNoSearch | TextBox | 空白 | ○ | 10 | 検索用カード番号 |

**バリデーション**:
- カードNo: 英数字10文字、棚入庫CSVに存在すること

**イベント**:
- btnSearch.Click: 入庫データ検索・表示

#### 3.3.2 入庫データエリア（読み取り専用）

| 項目名 | コントロール名 | コントロール型 | 説明 |
|--------|---------------|---------------|------|
| カードNo | lblCardNo | Label | 棚入庫CSVから取得 |
| 品名 | lblProductName | Label | 棚入庫CSVから取得 |
| ロットNo | lblLotNo | Label | 棚入庫CSVから取得 |
| 棚番 | lblShelfNo | Label | 棚入庫CSVから取得 |
| 入庫日時 | lblStorageDateTime | Label | 棚入庫CSVから取得 |
| 入庫担当者 | lblStorageEmployee | Label | 棚入庫CSVから取得 |

#### 3.3.3 出庫データ入力エリア

| 項目名 | コントロール名 | コントロール型 | 初期値 | 必須 | 最大長 | 説明 |
|--------|---------------|---------------|--------|------|--------|------|
| 出庫日時 | lblRetrievalDateTime | Label | 現在日時 | ○ | - | 自動設定 |
| 出庫担当者No | txtRetrievalEmployeeNo | TextBox | 空白 | ○ | 6 | 6桁の従業員番号 |
| 出庫担当者名 | lblRetrievalEmployeeName | Label | 空白 | - | - | 従業員マスタから取得 |
| 備考 | txtRemarks | TextBox | 空白 | × | 100 | 任意入力 |

**バリデーション**:
- 出庫担当者No: 半角数字6桁、従業員マスタに存在すること

**イベント**:
- txtRetrievalEmployeeNo.TextChanged: 出庫担当者名自動取得

#### 3.3.4 ボタン

| ボタン名 | コントロール名 | 初期状態 | 説明 |
|----------|---------------|----------|------|
| 検索 | btnSearch | 有効 | 入庫データ検索・表示 |
| 出庫実行 | btnExecute | 無効 | 棚出庫実行、CSV書込 |
| キャンセル | btnCancel | 有効 | 画面を閉じる |

**活性制御**:
- 検索成功時: btnExecute有効化
- 検索失敗時: btnExecute無効

### 3.4 イベント一覧

| イベント | トリガー | 処理内容 |
|----------|---------|----------|
| Load | 画面表示時 | 現在日時設定 |
| btnSearch.Click | 検索ボタン押下 | 棚入庫CSVから検索、データ表示 |
| txtRetrievalEmployeeNo.TextChanged | 出庫担当者No入力時 | 従業員名取得・表示 |
| btnExecute.Click | 出庫実行ボタン押下 | 出庫データをCSVに書込、DialogResult.OKで閉じる |
| btnCancel.Click | キャンセルボタン押下 | DialogResult.Cancelで閉じる |

---

## 4. 色・フォント仕様

### 4.1 色仕様

| 用途 | 色コード | 色名 | 使用箇所 |
|------|---------|------|----------|
| 情報メッセージ | #000000 | Black | lblMessage（情報） |
| 成功メッセージ | #008000 | Green | lblMessage（成功）、判定ラベル（OK） |
| エラーメッセージ | #FF0000 | Red | lblMessage（エラー）、判定ラベル（NG） |
| 背景色 | #F0F0F0 | Control | フォーム背景 |
| グループボックス背景 | #FFFFFF | White | グループボックス内背景 |
| ボタン背景 | #E0E0E0 | ButtonFace | ボタン背景 |

### 4.2 フォント仕様

| 項目 | フォント | サイズ | スタイル |
|------|---------|--------|----------|
| 画面タイトル | MS UI Gothic | 12pt | Bold |
| セクションタイトル | MS UI Gothic | 10pt | Bold |
| 通常ラベル | MS UI Gothic | 9pt | Regular |
| 入力フィールド | MS UI Gothic | 9pt | Regular |
| ボタン | MS UI Gothic | 9pt | Regular |
| メッセージエリア | MS UI Gothic | 10pt | Bold |

---

## 5. バリデーションルール一覧

### 5.1 入力チェック

| 項目名 | チェック内容 | エラーメッセージ | エラーコード |
|--------|-------------|-----------------|-------------|
| 従業員No | 必須チェック | 従業員Noを入力してください | ERROR-101 |
| 従業員No | 書式チェック（半角数字6桁） | 従業員Noは6桁の数字で入力してください | ERROR-102 |
| 従業員No | マスタ存在チェック | 従業員Noが見つかりません | ERROR-103 |
| カードNo | 必須チェック | カードNoを入力してください | ERROR-201 |
| カードNo | 書式チェック（英数字10文字） | カードNoは正しい形式で入力してください | ERROR-202 |
| カードNo | マスタ存在チェック | カードNoが見つかりません | ERROR-203 |
| LAP厚 | 必須チェック | LAP厚を選択してください | ERROR-204 |
| 備考 | 長さチェック（100文字以内） | 備考は100文字以内で入力してください | ERROR-301 |

### 5.2 業務チェック

| チェック内容 | エラーメッセージ | エラーコード |
|-------------|-----------------|-------------|
| 照合前に天秤データ取得失敗 | 天秤からデータを取得できませんでした | ERROR-401 |
| 第1段階照合NG（不足） | 不足: 投入前10mm（必要: X個、確保: Y個、不足: Z個） | ERROR-402 |
| 第1段階照合NG（過剰） | 過剰: 投入前10mm（必要: X個、確保: Y個、過剰: Z個） | ERROR-403 |
| 第2段階照合NG | 不足/過剰: 部材名（必要: X個、確保: Y個、過不足: Z個） | ERROR-404 |
| 棚入庫時に既に存在 | このカードNoは既に棚入庫されています | ERROR-501 |
| 棚出庫時にデータなし | 指定したカードNoは棚にありません | ERROR-502 |

---

## 6. アクセシビリティ対応

### 6.1 キーボード操作

| 操作 | キー | 動作 |
|------|------|------|
| 次の項目へ移動 | Tab | フォーカス移動 |
| 前の項目へ移動 | Shift + Tab | フォーカス移動（逆順） |
| カード情報取得 | Enter | txtCardNoでEnter時に条件取得 |
| 照合実行 | F5 | btnVerify.PerformClick() |
| キャンセル | Esc | btnCancel.PerformClick() |
| アプリ終了 | Alt + F4 | Application.Exit() |

### 6.2 タブオーダー

**メイン画面**:
1. txtEmployeeNo
2. txtCardNo
3. cmbLapThickness
4. btnVerify
5. btnShelfStorage
6. btnShelfRetrieval
7. btnCancel
8. btnExit

---

## 改訂履歴

| 版数 | 改訂日 | 改訂者 | 改訂内容 |
|------|--------|--------|----------|
| 1.0 | 2025-11-10 | システム開発チーム | 初版作成 |

