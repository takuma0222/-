# メッセージ一覧

## 1. 情報メッセージ（黒色）

| メッセージID | メッセージ内容 | 表示タイミング | 備考 |
|-------------|---------------|---------------|------|
| INFO-001 | カードNoを入力してください | 従業員認証成功後 | カードNo入力欄にフォーカス移動時 |
| INFO-002 | 秤の値測定中... | カード情報取得後 | 天秤から初回データ取得中 |
| INFO-003 | 各部材を必要枚数分準備してください | 初回計測完了後 | 照合ボタンが活性化される |
| INFO-004 | 条件なし | カード条件が存在しない場合 | 照合ボタンは非活性 |

---

## 2. 成功メッセージ（緑色）

| メッセージID | メッセージ内容 | 表示タイミング | 備考 |
|-------------|---------------|---------------|------|
| SUCCESS-001 | 照合OK。投入前10mmをプロトスに入れて移載してください<br>移載後、投入後1mm/5mm/10mmの必要枚数を用意して再照合してください | 第1段階照合成功時 | 2行表示<br>セッション状態保存 |
| SUCCESS-002 | 照合OK | 第2段階照合成功時（全部材OK） | ログ記録<br>セッション状態削除 |

---

## 3. エラーメッセージ（赤色）

### 3.1 照合エラー

| メッセージID | メッセージ内容 | 表示タイミング | 備考 |
|-------------|---------------|---------------|------|
| ERROR-001 | 不足: 投入前10mm 必要{必要枚数}個 使用{使用枚数}個 不足{不足枚数}個 | 第1段階照合で不足が発生 | {変数}は実際の値に置換 |
| ERROR-002 | 過剰: 投入前10mm 必要{必要枚数}個 使用{使用枚数}個 不足{不足枚数}個 | 第1段階照合で過剰が発生 | 不足枚数は負の値 |
| ERROR-003 | 不足: {部材名} 必要{必要枚数}個 使用{使用枚数}個 不足{不足枚数}個 | 第2段階照合で不足が発生 | 部材名: 投入後1mm/5mm/10mm等 |
| ERROR-004 | 過剰: {部材名} 必要{必要枚数}個 使用{使用枚数}個 不足{不足枚数}個 | 第2段階照合で過剰が発生 | 部材名: 投入後1mm/5mm/10mm等 |

### 3.2 認証エラー

| メッセージID | メッセージ内容 | 表示タイミング | 備考 |
|-------------|---------------|---------------|------|
| ERROR-101 | 該当するユーザがありません。 | 従業員Noが従業員マスタに存在しない | 従業員名表示欄に「ユーザなし」と表示 |

### 3.3 入力エラー

| メッセージID | メッセージ内容 | 表示タイミング | 備考 |
|-------------|---------------|---------------|------|
| ERROR-201 | カードNoは6桁で入力してください | カードNoが6桁でない場合 | カード情報クリア |

### 3.4 システムエラー

| メッセージID | メッセージ内容 | 表示タイミング | 備考 |
|-------------|---------------|---------------|------|
| ERROR-301 | 計測エラー:{エラーメッセージ} | 天秤からのデータ取得失敗時 | エラーメッセージは最大20文字 |
| ERROR-302 | データ読み取りエラーが発生しました | CSVファイル読み込み失敗時 | 従業員名表示欄に「ユーザなし」と表示 |
| ERROR-303 | セッション復元エラー: {エラーメッセージ} | セッション復元時のエラー | MessageBox表示後、フォームリセット |

---

## 4. 確認ダイアログ

### 4.1 操作確認

| ダイアログID | タイトル | メッセージ内容 | ボタン | 表示タイミング |
|-------------|---------|---------------|--------|---------------|
| CONFIRM-001 | 確認 | 入力内容をクリアしますか？ | はい / いいえ | キャンセルボタン押下時 |
| CONFIRM-002 | 確認 | アプリケーションを終了しますか？ | はい / いいえ | フォームクローズ時 |

### 4.2 セッション復元確認

| ダイアログID | タイトル | メッセージ内容 | ボタン | 表示タイミング |
|-------------|---------|---------------|--------|---------------|
| CONFIRM-101 | セッション復元確認 | 前回の照合作業が途中で終了しています。<br>従業員No: {従業員No}<br>カードNo: {カードNo}<br>LAP厚: {LAP厚}<br><br>前回の状態から再開しますか？ | はい / いいえ | アプリ起動時<br>（session_state.jsonが存在する場合） |

---

## 5. 棚管理メッセージ

### 5.1 棚入庫メッセージ

| メッセージID | メッセージ内容 | 表示タイミング | 備考 |
|-------------|---------------|---------------|------|
| STORAGE-001 | 入庫情報を登録しました。 | 棚入庫完了時 | MessageBox表示 |
| STORAGE-002 | 棚番号を入力してください。 | 棚番号未入力で入庫ボタン押下時 | MessageBox表示 |

### 5.2 棚出庫メッセージ

| メッセージID | メッセージ内容 | 表示タイミング | 備考 |
|-------------|---------------|---------------|------|
| RETRIEVAL-001 | 出庫情報を登録しました。 | 棚出庫完了時 | MessageBox表示 |
| RETRIEVAL-002 | 検索条件を入力してください。 | 検索条件未入力で検索ボタン押下時 | MessageBox表示 |
| RETRIEVAL-003 | 出庫する入庫情報を選択してください。 | 入庫情報未選択で出庫ボタン押下時 | MessageBox表示 |
| RETRIEVAL-004 | 出庫枚数を入力してください。 | 出庫枚数未入力で出庫ボタン押下時 | MessageBox表示 |
| RETRIEVAL-005 | 出庫枚数が入庫枚数を超えています。 | 出庫枚数 > 入庫枚数の場合 | MessageBox表示 |
| RETRIEVAL-006 | この入庫情報は既に出庫済みです。 | 出庫済みフラグ=Trueの場合 | MessageBox表示 |

---

## 6. メッセージ表示仕様

### 6.1 メッセージ表示領域
- **高さ**: 140px
- **フォントサイズ**: 13pt
- **最大行数**: 2行
- **テキスト配置**: 中央揃え

### 6.2 色の使い分け

| 色 | RGB値 | 用途 |
|----|-------|------|
| 黒色 | (0, 0, 0) | 情報メッセージ、条件なし |
| 緑色 | (0, 128, 0) | 成功メッセージ（照合OK） |
| 赤色 | (255, 0, 0) | エラーメッセージ、警告メッセージ |

### 6.3 メッセージ表示タイミング

1. **即時表示**: 
   - 照合結果メッセージ
   - 入力エラーメッセージ
   - 認証エラーメッセージ

2. **処理中表示**:
   - 「秤の値測定中...」（天秤データ取得中）

3. **処理完了後表示**:
   - 「各部材を必要枚数分準備してください」（初回計測完了後）
   - 「照合OK」（第2段階照合完了後）

### 6.4 メッセージクリア

メッセージは以下のタイミングで次のメッセージに上書きされます：
- 新しい操作（照合、キャンセル等）実行時
- 従業員No入力時
- カードNo入力時

---

## 7. ログメッセージ

### 7.1 照合ログ（logs/YYYYMMDD.csv）

| 項目 | 内容 | 例 |
|------|------|-----|
| タイムスタンプ | YYYY-MM-DD HH:MM:SS | 2025-11-10 14:30:45 |
| 従業員No | 6桁 | 123456 |
| カードNo | 6桁 | E00123 |
| 品名 | 文字列 | AAA |
| ロットNo | 文字列 | 000001### |
| 照合結果 | OK/NG:詳細 | OK または NG:第1段階(不足) |

### 7.2 エラーログ（logs/error/YYYYMMDD_error.log）

形式: `[YYYY-MM-DD HH:MM:SS] エラーメッセージ`

例:
```
[2025-11-10 14:35:20] 初回計測エラー: COM3ポートが開けません
[2025-11-10 14:40:15] セッション復元エラー: JSONファイルが破損しています
```

---

## 8. 変数置換仕様

メッセージ内の変数は以下の形式で記述します：

| 変数名 | 説明 | 例 |
|--------|------|-----|
| {必要枚数} | カード条件から取得した必要枚数 | 1 |
| {使用枚数} | 天秤から計測した照合後の枚数 | 2 |
| {不足枚数} | 必要枚数 - 使用枚数 | -1（過剰の場合は負の値） |
| {部材名} | 投入後1mm、投入後5mm、投入後10mm等 | 投入後1mm |
| {従業員No} | ログイン中の従業員番号 | 123456 |
| {カードNo} | 照合対象のカード番号 | E00123 |
| {LAP厚} | 選択されたLAP厚 | 250μm |
| {エラーメッセージ} | 例外メッセージ | COM3ポートが開けません |

---

## 9. メッセージ国際化対応（将来対応）

現在は日本語のみ対応していますが、将来的に多言語対応する場合の準備：

- メッセージIDベースの管理
- リソースファイル（.resx）への移行
- 言語切替機能の実装

---

## 改訂履歴

| 版数 | 改訂日 | 改訂者 | 改訂内容 |
|------|--------|--------|----------|
| 1.0 | 2025-11-10 | システム開発チーム | 初版作成 |

